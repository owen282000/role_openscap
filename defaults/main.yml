---
# Defaults file for role_openscap

# Package variables
# These variables define the names of the required packages for OpenSCAP and its components
openscap_package_name: "openscap-scanner"  # Name of the OpenSCAP package
ssg_package_name: "scap-security-guide"    # Name of the SCAP Security Guide package
unzip_package_name: "unzip"                # Name of the unzip package

# Command variables
# Command to check the OpenSCAP version
openscap_version_command: "oscap -V"

# SCAP Security Guide related variables
# These variables define the version, URL, and directory structure for downloading and storing SCAP Security Guide files
ssg_version: "0.1.69"  # SCAP Security Guide version
ssg_url: "https://github.com/ComplianceAsCode/content/releases/download/{{ ssg_version }}/scap-security-guide-{{ ssg_version }}.zip" # URL SCAP Security Guide
ssg_content_directory: "/usr/share/xml/scap/ssg/content/"  # Directory where SCAP content will be stored
ssg_file_check: ".scap_security_guide_installed"  # Marker file to check if SCAP content has already been installed

# SCAP Guide files per OS distribution and version
# These mappings define the default SCAP XML guide files for specific distributions and versions
ssg_guide_files:
  Ubuntu:
    "16": "scap-security-guide-{{ ssg_version }}/ssg-ubuntu1604-ds-1.2.xml"   # Ubuntu 16.04 SCAP Guide
    "18": "scap-security-guide-{{ ssg_version }}/ssg-ubuntu1804-ds-1.2.xml"   # Ubuntu 18.04 SCAP Guide
    "20": "scap-security-guide-{{ ssg_version }}/ssg-ubuntu2004-ds-1.2.xml"   # Ubuntu 20.04 SCAP Guide
    "22": "scap-security-guide-{{ ssg_version }}/ssg-ubuntu2204-ds-1.2.xml"   # Ubuntu 22.04 SCAP Guide
  RedHat:
    "7": "scap-security-guide-{{ ssg_version }}/ssg-rhel7-ds-1.2.xml"         # Red Hat Enterprise Linux 7 SCAP Guide
    "8": "scap-security-guide-{{ ssg_version }}/ssg-rhel8-ds-1.2.xml"         # Red Hat Enterprise Linux 8 SCAP Guide
    "9": "scap-security-guide-{{ ssg_version }}/ssg-rhel9-ds-1.2.xml"         # Red Hat Enterprise Linux 9 SCAP Guide
  SUSE:
    "12": "scap-security-guide-{{ ssg_version }}/ssg-sle12-ds-1.2.xml"        # SUSE Linux Enterprise 12 SCAP Guide
    "15": "scap-security-guide-{{ ssg_version }}/ssg-sle15-ds-1.2.xml"        # SUSE Linux Enterprise 15 SCAP Guide

# Fallback SCAP Guide file if no specific file is available for the OS distribution/version
ssg_default_guide_file: "scap-security-guide-{{ ssg_version }}/ssg-generic-ds-1.2.xml"

##### TODO: Make the SCAP guide file overwritable using host/group_vars for flexibility

# SCAP Profile variables
# Default SCAP profile to use during scans. This can be customized per OS or host.
ssg_profile: "xccdf_org.ssgproject.content_profile_cis_level1_server"  # Default SCAP profile

##### TODO: Define default profile per ansible_distribution_version

# Reporting variables
# These variables define where the scan reports will be stored and their naming convention
report_directory: "/var/log/openscap/reports"  # Directory on the master node to store reports
report_filename: "{{ inventory_hostname }}-{{ ansible_date_time.iso8601 }}-report.html"  # Filename pattern for reports (based on hostname and timestamp)
report_storage_server: "localhost"  # Server where reports will be stored
...
